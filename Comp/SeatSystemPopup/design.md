# 座席管理システム警告プログラム 設計書

## 1. 概要
本プログラムは、PCのログインユーザが座席管理システムへの出社等の登録忘れを防止するため、定期的にユーザの状態を確認し、必要に応じて警告メッセージを表示します。

## 2. システム構成
- Windows 11 PC
- Python3 実行環境
- タスクスケジューラによる定期実行
- ユーザテーブルCSVファイル（C:\scan\座席管理システム\user.csv）

## 3. 処理フロー
1. ログインユーザ名の取得
2. ユーザテーブルCSVファイルの更新日時を確認（15分以内か判定）
3. CSVファイルを読み込み、UserID列がログインユーザ名と前方一致する行を検索
4. Status列の値を取得
5. Statusが「退社」の場合、トースト通知を表示（「座席管理システムを開く」ボタン付き）
6. それ以外の場合は何もせず終了

## 4. 詳細設計
### 4.1 ログインユーザ名の取得
- `os.getlogin()` または `getpass.getuser()` を使用

### 4.2 CSVファイルの更新日時確認
- `os.path.getmtime()` で最終更新時刻を取得し、現在時刻との差分を計算

### 4.3 CSVファイルの読み込み
- `csv` モジュールで読み込み
- UserID列がログインユーザ名で前方一致する行を抽出

### 4.4 トースト通知の表示
- `win10toast_click` などのライブラリを利用
- タイトル: ★座席管理システム
- 本文: 状態が「退社」となっています。登録をお願いします。
- ボタン: 「座席管理システムを開く」
- URL: http://www.google.com

### 4.5 エラー処理
- ファイルが存在しない場合や読み込みエラー時は何もせず終了

## 5. モジュール構成
- seatSystemPopup.py : メイン処理

## 6. 今後の拡張
- 設定ファイルによるパスやURLの外部化
- 通知方法のカスタマイズ
